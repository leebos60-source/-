import pandas as pd
import os

# 1. 기존 파일 로드
file_path = '2024_전기공사_통합데이터.xlsx'
if os.path.exists(file_path):
    df = pd.read_excel(file_path)
else:
    # 파일이 없으면 빈 데이터프레임 생성 (혹시 모를 에러 방지)
    df = pd.DataFrame(columns=['공고명', '발주처', '공고일', '기초금액', '예정가격', '낙찰금액', '낙찰하한율', '낙찰률', '사정율'])

# 2. 이미지에서 추출 및 역산한 데이터
# 공고명: 2026년 버스정류소 전기시설 유지보수 공사(연간단기)
# 발주처: 경기도 김포시
# 공고일: 2026/01/21 (개찰일시 기준)
# 기초금액: 55,000,000
# 1순위 투찰금액: 49,118,351
# 1순위 투찰률: 90.236%
# 역산(예정가격) = 49,118,351 / 0.90236 ≈ 54,433,210
# 사정율 = (54,433,210 / 55,000,000) * 100 ≈ 98.9695

new_data = {
    '공고명': "2026년 버스정류소 전기시설 유지보수 공사(연간단기)",
    '발주처': "경기도 김포시",
    '공고일': "2026-01-21",
    '기초금액': 55000000,
    '예정가격': 54433210,
    '낙찰금액': 49118351,
    '낙찰하한율': 87.745, # 통상적인 값 (추정) 또는 없음
    '낙찰률': 90.236,
    '사정율': 98.9695
}

# 3. 데이터 추가
new_row = pd.DataFrame([new_data])
df = pd.concat([new_row, df], ignore_index=True)

# 4. 저장
df.to_excel(file_path, index=False)
print(f"Added 1 row. Total rows: {len(df)}")
print(df.head(1).T)
